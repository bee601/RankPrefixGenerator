<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ItemsAdder Style Prefix Gen</title>
  <link href="https://fonts.googleapis.com/css2?family=Silkscreen&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #1a1a1a; --panel: #252525; --accent: #3498db; }
    body { background: var(--bg); color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 40px; }
    
    .preview-container { 
      background: repeating-conic-gradient(#333 0% 25%, #222 0% 50%) 50% / 20px 20px; 
      padding: 60px; border-radius: 8px; margin-bottom: 20px;
    }

    /* Vorschau-Box: Simuliert das Ingame-Verhalten */
    #prefixPreview {
      display: inline-block;
      padding: 1px 3px;
      border: 1px solid #ff0000;
      font-family: 'Silkscreen', monospace;
      font-size: 8px; /* Original Pixelgröße */
      line-height: 8px;
      text-transform: uppercase;
      image-rendering: pixelated;
      transform: scale(8); /* Zoomt die Vorschau heran, ohne sie unscharf zu machen */
    }

    .ui-panel { background: var(--panel); padding: 25px; border-radius: 12px; width: 600px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    input[type="text"], input[type="color"] { width: 100%; padding: 8px; background: #111; border: 1px solid #444; color: white; border-radius: 4px; }
    .color-item { background: #333; padding: 10px; border-radius: 4px; margin-bottom: 10px; display: flex; gap: 10px; }
    button { cursor: pointer; border: none; padding: 10px; border-radius: 4px; font-weight: bold; }
    .btn-dl { grid-column: span 2; background: #27ae60; color: white; padding: 15px; margin-top: 10px; }
    .btn-add { background: #3498db; color: white; width: 100%; margin-bottom: 10px; }
  </style>
</head>
<body>

  <h1>Prefix Generator (Pixel-Perfect)</h1>

  <div class="preview-container">
    <div id="prefixPreview">OWNER</div>
  </div>

  <div class="ui-panel">
    <div>
      <label>Text</label>
      <input type="text" id="pText" value="OWNER" oninput="draw()">
      <br><br>
      <label>Rahmenfarbe (HEX)</label>
      <input type="text" id="hBorder" value="#FF0000" oninput="syncColor('hBorder', 'cBorder')">
      <input type="color" id="cBorder" value="#ff0000" oninput="syncHex('cBorder', 'hBorder')">
    </div>

    <div>
      <label>Hintergrund (Gradient)</label>
      <button class="btn-add" onclick="addBg()">+ Farbe</button>
      <div id="bgList"></div>
    </div>

    <button class="btn-dl" onclick="download()">DOWNLOAD PNG (8px hoch)</button>
  </div>

  <script>
    let bgs = ['#4D0000', '#1A0000'];

    function syncColor(tid, pid) { 
        let val = document.getElementById(tid).value;
        if(/^#[0-9A-F]{6}$/i.test(val)) { document.getElementById(pid).value = val; draw(); }
    }
    function syncHex(pid, tid) {
        document.getElementById(tid).value = document.getElementById(pid).value.toUpperCase();
        draw();
    }

    function addBg() { bgs.push('#000000'); renderBgs(); draw(); }
    function removeBg(i) { if(bgs.length > 1) { bgs.splice(i,1); renderBgs(); draw(); } }

    function renderBgs() {
        const list = document.getElementById('bgList');
        list.innerHTML = '';
        bgs.forEach((c, i) => {
            list.innerHTML += `
                <div class="color-item">
                    <input type="text" value="${c}" oninput="bgs[${i}]=this.value; draw()">
                    <button onclick="removeBg(${i})">X</button>
                </div>`;
        });
    }

    function draw() {
        const txt = document.getElementById('pText').value.toUpperCase();
        const border = document.getElementById('hBorder').value;
        const pre = document.getElementById('prefixPreview');

        pre.innerText = txt;
        pre.style.borderColor = border;
        pre.style.background = bgs.length > 1 ? `linear-gradient(90deg, ${bgs.join(',')})` : bgs[0];
    }

    function download() {
        const text = document.getElementById('pText').value.toUpperCase();
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');

        // Font Vorbereitung
        ctx.font = "8px 'Silkscreen'";
        const tw = Math.ceil(ctx.measureText(text).width);
        
        canvas.width = tw + 6;
        canvas.height = 8;

        // Pixel-Modus erzwingen
        ctx.imageSmoothingEnabled = false;

        // 1. Hintergrund
        const grad = ctx.createLinearGradient(0,0,canvas.width,0);
        bgs.forEach((c,i) => grad.addColorStop(i/(bgs.length-1 || 1), c));
        ctx.fillStyle = grad;
        ctx.fillRect(0,0,canvas.width, canvas.height);

        // 2. Rahmen
        ctx.strokeStyle = document.getElementById('hBorder').value;
        ctx.lineWidth = 1;
        ctx.strokeRect(0.5, 0.5, canvas.width-1, canvas.height-1);

        // 3. Schatten (Das macht den Ingame-Look!)
        ctx.fillStyle = "rgba(0,0,0,0.6)";
        ctx.fillText(text, 3.5, 7.5); // Versatz um 1 Pixel

        // 4. Weißer Text
        ctx.fillStyle = "#FFFFFF";
        ctx.fillText(text, 3, 7);

        const a = document.createElement('a');
        a.href = canvas.toDataURL();
        a.download = "rank.png";
        a.click();
    }

    renderBgs();
    draw();
  </script>
</body>
</html>
